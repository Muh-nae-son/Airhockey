// ----- STATES -----
#define STATE_IDLE   0
#define STATE_ACTIVE 1

int systemState = STATE_IDLE;

// IR break-beam sensor
const int PENNY_BEAM_PIN = 17;  // LOW = broken, HIGH = unbroken

void setup() {
  // put your setup code here, to run once:
Serial.begin(115200);

// Beam sensor
    pinMode(PENNY_BEAM_PIN, INPUT);
}

void loop() {
  if (systemState == STATE_IDLE) {
    // check beam condition
    Serial.println("Please Insert Penny...");
    if (digitalRead(PENNY_BEAM_PIN) == LOW) {
      // Beam broken -> enter ACTIVE state
        Serial.println("Penny Inserted! Starting Game");
        systemState = STATE_ACTIVE;

        //Can also run any initialization/start of game code here. Like flashing lights or buzzers to say game is starting
        }

        return;
  }

 if (systemState == STATE_ACTIVE) {
  Serial.println("OMG you're playing the game!!!!");
  if (digitalRead(PENNY_BEAM_PIN) == HIGH) {
    Serial.println("Game Over! Nice Playing! Come Play Again!");
    systemState = STATE_IDLE;

    // Stop fans with ledcWrite
  }

  return;
 }

}
